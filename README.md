# AI Travel Agent Telegram Bot

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ —Ç—É—Ä–æ–≤ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Level.Travel API –∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

## –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- üß† **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
- ‚öñÔ∏è **–°–∏—Å—Ç–µ–º–∞ –≤–µ—Å–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –∫—Ä–∏—Ç–µ—Ä–∏—è (–∑–≤–µ–∑–¥–Ω–æ—Å—Ç—å, –ª–∏–Ω–∏—è –ø–ª—è–∂–∞, –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ç.–¥.)
- üîÑ **–§–æ–Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Ç—É—Ä–æ–≤ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö
- üë• **–ì—Ä—É–ø–ø–æ–≤–æ–π –ø–æ–¥–±–æ—Ä —Ç—É—Ä–æ–≤** - —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –ø–æ–∏—Å–∫ —Å —É—á–µ—Ç–æ–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- üó≥ **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞ —Ç—É—Ä—ã** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ –≥—Ä—É–ø–ø–∞—Ö
- ‚è∞ **–£–º–Ω—ã–µ –¥–µ–¥–ª–∞–π–Ω—ã** - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ –ø–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞
- üéØ **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ AI** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ OpenRouter –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å —Ñ–æ–ª–ª–±–µ–∫–æ–º –Ω–∞ –±–∞–∑–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥)
- üì± **Telegram Mini App** - —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## MVP-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –ø—Ä–æ–≤–∞–π–¥–µ—Ä —Ç—É—Ä–æ–≤ ‚Äî **Level.Travel** (–æ—Ö–≤–∞—Ç 90+ –¢–û)
- –†–µ–∂–∏–º –±–æ—Ç–∞: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –æ–±–∞ —Ä–µ–∂–∏–º–∞ ‚Äî **webhook** –∏ **polling** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é polling)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: —á–∞—Å–æ–≤–æ–π —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞—á, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ ‚â• 85%

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ client              # Frontend –Ω–∞ React (Telegram Mini App)
‚îÇ   ‚îú‚îÄ‚îÄ src
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components  # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks       # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib         # –£—Ç–∏–ª–∏—Ç—ã –∏ API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pages       # –°—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ db                  # Drizzle ORM –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ migrations      # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ index.ts        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ server              # Backend –Ω–∞ Express
‚îÇ   ‚îú‚îÄ‚îÄ bot             # –õ–æ–≥–∏–∫–∞ Telegram-–±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ middleware      # Express middleware
‚îÇ   ‚îú‚îÄ‚îÄ monitoring      # –ú–µ—Ç—Ä–∏–∫–∏ –∏ health checks
‚îÇ   ‚îú‚îÄ‚îÄ providers       # –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã —Ç—É—Ä–æ–≤ (Level.Travel)
‚îÇ   ‚îú‚îÄ‚îÄ routes          # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ services        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ validators      # –°—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (Zod)
‚îú‚îÄ‚îÄ shared              # –û–±—â–∏–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Ç–∏–ø—ã
‚îî‚îÄ‚îÄ tests               # –¢–µ—Å—Ç—ã (unit –∏ integration)
```

## –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã Telegram-–±–æ—Ç–∞

- Polling (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ URL
- Webhook: —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL `APP_URL`

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤:

```
TELEGRAM_USE_WEBHOOK=true
APP_URL=https://yourdomain.com
```

Webhook endpoint: `POST /api/telegram/webhook`

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:

```bash
# –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å UI –¥–ª—è –ë–î –∏ Redis)
docker-compose -f docker-compose.dev.yml up -d

# –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
docker-compose up -d
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ dev:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: http://localhost:5000
- Adminer (PostgreSQL UI): http://localhost:8080
- Redis Commander: http://localhost:8081

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–æ

1. `npm install`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env`
3. –ü–æ–¥–Ω–∏–º–∏—Ç–µ PostgreSQL –∏ Redis
4. `npm run db:push`
5. `npm run dev`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
npm test
npm run test:integration
```

## API Endpoints (–æ—Å–Ω–æ–≤–Ω—ã–µ)

- `GET /api/profile/:userId`
- `POST /api/profile`
- `POST /api/analyze-request`
- `GET /api/tours`
- `POST /api/group/create`
- `POST /api/group/vote`
- `GET /api/health`
- `GET /metrics`
- `POST /api/telegram/webhook` (–µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω webhook)

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (MVP)

```bash
# –ë–î
DATABASE_URL=postgresql://user:password@host:5432/database

# Telegram
TELEGRAM_TOKEN=your_bot_token
TELEGRAM_USE_WEBHOOK=false           # true –¥–ª—è webhook
APP_URL=https://yourdomain.com       # –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è webhook

# AI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
OPENROUTER_API_KEY=

# Level.Travel
LEVELTRAVEL_API_KEY=your_leveltravel_api_key
LEVEL_TRAVEL_PARTNER=627387
LEVEL_TRAVEL_MARKER=marker
LEVEL_TRAVEL_AFFILIATE_URL=https://example.com/aff

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWT/CSRF/–°–µ—Å—Å–∏–∏
JWT_ACCESS_SECRET=...
JWT_REFRESH_SECRET=...
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
JWT_ISSUER=ai-travel-agent
JWT_AUDIENCE=ai-travel-agent-api
CSRF_SECRET=...
COOKIE_SECRET=...
SESSION_SECRET=...

# App
APP_URL=http://localhost:5000
NODE_ENV=development
LOG_LEVEL=info
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ Observability (MVP)

- JWT, CSRF, Helmet, Rate limiting, Zod
- –ú–µ—Ç—Ä–∏–∫–∏ Prometheus: `/metrics`, `/api/health`
- –õ–æ–≥–∏ Winston c correlation ID
- Graceful shutdown

## –ü—Ä–æ–¥—á–µ–∫‚Äë–ª–∏—Å—Ç –¥–ª—è MVP

- Level.Travel: —Ç–∞–π–º–∞—É—Ç—ã, —Ä–µ—Ç—Ä–∞–∏, –∫—ç—à, –∞—Ñ—Ñ–∏–ª–∏–∞—Ç —Å—Å—ã–ª–∫–∏
- –ë–æ—Ç: –≤–∫–ª—é—á–∏—Ç—å webhook –≤ –ø—Ä–æ–¥–µ; –∑–∞–¥–∞—Ç—å `APP_URL`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –∞–ª–µ—Ä—Ç—ã –Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞, –æ—à–∏–±–∫–∏ 5xx, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –ë—ç–∫–∞–ø—ã Postgres/Redis; —Å–µ–∫—Ä–µ—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è/secret‚Äëstore

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- [ARCHITECTURE.md](./ARCHITECTURE.md)
- [API.md](./API.md)
- [DEPLOYMENT.md](./DEPLOYMENT.md)
- [MONITORING.md](./MONITORING.md)
- [SSL_SETUP.md](./SSL_SETUP.md)